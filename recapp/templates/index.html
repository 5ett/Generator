{% extends 'origin.html' %}

{% block head %}
    <script defer src="{{ url_for('static', filename='/scripts/home.js') }}"></script>
    <script defer src="{{ url_for('static', filename='/scripts/supreme.js') }}"></script>
{% endblock %}

{% block nav %}
    <li>
        <form class="for-nav" method="POST">
          {{ search.hidden_tag() }}
              {{ search.search_bar(class='top-on', placeholder='search') }}
        </form>
    </li>
{% endblock %}

{% block sidebar %}
{% endblock %}

{% block content %}

        {% if current_user.is_authenticated %}
            <div class="main-content">
                <div class="container">
                    <div class="greetings">
                        <p class="text-muted">Good {{ time }},</p>
                        <h1>{{ current_user.name }}</h1>
                    </div>

                    <div class="search">
                        <form class="for-nav faux" method="POST">
                          {{ search.hidden_tag() }}
                          {{ search.search_bar(class='top-on', placeholder='search') }}
                          {{ search.search_action(class='search-btn gen-btn btn') }}
                        </form>
                    </div>

                <div class="plaque">
                    <h1>New form</h1>
                    <div class="plaque-items">

                        <a href="{{url_for('add_head', ticket_type='quote')}}">
                            <div class="plaque-lg plg-1" id="proforma">
                                <svg xmlns="http://www.w3.org/2000/svg" width="23.66" height="21.51" viewBox="0 0 43.662 39.693">
                                  <path id="list" d="M38.708,5.969H6.954A1.985,1.985,0,0,0,4.969,7.954V35.739a1.985,1.985,0,0,0,1.985,1.985H38.708a1.985,1.985,0,0,0,1.985-1.985V7.954A1.985,1.985,0,0,0,38.708,5.969ZM6.954,2A5.954,5.954,0,0,0,1,7.954V35.739a5.954,5.954,0,0,0,5.954,5.954H38.708a5.954,5.954,0,0,0,5.954-5.954V7.954A5.954,5.954,0,0,0,38.708,2Zm3.969,9.923h3.969v3.969H10.923Zm9.923,0a1.985,1.985,0,0,0,0,3.969H32.754a1.985,1.985,0,1,0,0-3.969Zm-5.954,7.939H10.923v3.969h3.969Zm3.969,1.985a1.985,1.985,0,0,1,1.985-1.985H32.754a1.985,1.985,0,1,1,0,3.969H20.846A1.985,1.985,0,0,1,18.862,21.846ZM14.892,27.8H10.923V31.77h3.969Zm3.969,1.985A1.985,1.985,0,0,1,20.846,27.8H32.754a1.985,1.985,0,1,1,0,3.969H20.846A1.985,1.985,0,0,1,18.862,29.785Z" transform="translate(-1 -2)" fill="#fff" fill-rule="evenodd"/>
                                </svg>

                                <h2>Proforma</h2>
                                <p>Generate new quote.</p>
                            </div>
                        </a>

                        <a href="{{url_for('add_head', ticket_type='receipt')}}">
                            <div class="plaque-lg plg-2" id="receipt">
                                <svg xmlns="http://www.w3.org/2000/svg" width="23.771" height="21.509" viewBox="0 0 23.771 21.509">
                                  <g id="Group_84" data-name="Group 84" transform="translate(-13912 -3635.978)">
                                    <g id="Exclusion_1" data-name="Exclusion 1" transform="translate(13915.633 3635.978)" fill="none">
                                      <path d="M15.338,18.309h2.653c1.183,0,2.147-1.281,2.147-2.855V2.856C20.138,1.281,19.174,0,17.991,0H2.147C.964,0,0,1.281,0,2.856V4H13.191c1.185,0,2.147,1.281,2.147,2.856V18.308Z" stroke="none"/>
                                      <path d="M 17.99127578735352 16.70925712585449 C 18.1231861114502 16.70925712585449 18.53843688964844 16.25031661987305 18.53843688964844 15.45414638519287 L 18.53843688964844 2.855776786804199 C 18.53843688964844 2.01854681968689 18.09575653076172 1.59999680519104 17.99127578735352 1.59999680519104 L 2.147156715393066 1.59999680519104 C 2.063663244247437 1.59999680519104 1.764189124107361 1.867296695709229 1.647249698638916 2.401946783065796 L 13.19074630737305 2.401946783065796 C 15.29195690155029 2.401946783065796 16.93789672851563 4.359156608581543 16.93789672851563 6.857717037200928 L 16.93789672851563 16.70925712585449 L 17.99127578735352 16.70925712585449 M 17.99127578735352 18.30925750732422 L 15.33939647674561 18.30925750732422 L 15.3378963470459 18.30925750732422 L 15.3378963470459 18.30842590332031 L 15.3378963470459 6.857717037200928 C 15.3378963470459 5.283316612243652 14.37532711029053 4.001946926116943 13.19074630737305 4.001946926116943 L -3.271789637437905e-06 4.001946926116943 L -3.271789637437905e-06 2.855776786804199 C -3.271789637437905e-06 1.281376838684082 0.9642367362976074 -3.153686520818155e-06 2.147156715393066 -3.153686520818155e-06 L 17.99127578735352 -3.153686520818155e-06 C 19.17436599731445 -3.153686520818155e-06 20.13843727111816 1.281376838684082 20.13843727111816 2.855776786804199 L 20.13843727111816 15.45414638519287 C 20.13843727111816 17.0285472869873 19.17436599731445 18.30925750732422 17.99127578735352 18.30925750732422 Z" stroke="none" fill="#fff"/>
                                    </g>
                                    <g id="Path_38" data-name="Path 38" transform="translate(13912 3639.18)" fill="none">
                                      <path d="M2.146,0H17.991c1.185,0,2.146,1.278,2.146,2.855v12.6c0,1.577-.961,2.855-2.146,2.855H2.146C.961,18.307,0,17.029,0,15.452V2.855C0,1.278.961,0,2.146,0Z" stroke="none"/>
                                      <path d="M 2.146324157714844 1.599996566772461 C 2.014614105224609 1.599996566772461 1.599994659423828 2.058986663818359 1.599994659423828 2.855236053466797 L 1.599994659423828 15.45187568664551 C 1.599994659423828 16.24812507629395 2.014614105224609 16.70711517333984 2.146324157714844 16.70711517333984 L 17.99127578735352 16.70711517333984 C 18.12298393249512 16.70711517333984 18.53760528564453 16.24812507629395 18.53760528564453 15.45187568664551 L 18.53760528564453 2.855236053466797 C 18.53760528564453 2.058986663818359 18.12298393249512 1.599996566772461 17.99127578735352 1.599996566772461 L 2.146324157714844 1.599996566772461 M 2.146324157714844 -3.814697265625e-06 L 17.99127578735352 -3.814697265625e-06 C 19.17666435241699 -3.814697265625e-06 20.13760566711426 1.278335571289063 20.13760566711426 2.855236053466797 L 20.13760566711426 15.45187568664551 C 20.13760566711426 17.02877616882324 19.17666435241699 18.30711555480957 17.99127578735352 18.30711555480957 L 2.146324157714844 18.30711555480957 C 0.9609451293945313 18.30711555480957 -5.7220458984375e-06 17.02877616882324 -5.7220458984375e-06 15.45187568664551 L -5.7220458984375e-06 2.855236053466797 C -5.7220458984375e-06 1.278335571289063 0.9609451293945313 -3.814697265625e-06 2.146324157714844 -3.814697265625e-06 Z" stroke="none" fill="#fff"/>
                                    </g>
                                    <path id="Path_44" data-name="Path 44" d="M1.36,0A1.36,1.36,0,1,1,0,1.36,1.36,1.36,0,0,1,1.36,0Z" transform="translate(13925.01 3652.256)" fill="#fff"/>
                                    <path id="Path_39" data-name="Path 39" d="M.231,0H10.922c.127,0,.231.4.231.9s-.1.9-.231.9H.231C.1,1.792,0,1.391,0,.9S.1,0,.231,0Z" transform="translate(13916.201 3643.113)" fill="#fff"/>
                                    <path id="Path_40" data-name="Path 40" d="M.231,0H10.922c.127,0,.231.4.231.9s-.1.9-.231.9H.231C.1,1.792,0,1.391,0,.9S.1,0,.231,0Z" transform="translate(13916.201 3646.374)" fill="#fff"/>
                                    <path id="Path_41" data-name="Path 41" d="M.231,0H10.922c.127,0,.231.4.231.9s-.1.9-.231.9H.231C.1,1.792,0,1.391,0,.9S.1,0,.231,0Z" transform="translate(13916.201 3649.635)" fill="#fff"/>
                                  </g>
                                </svg>


                                <h2>Receipt</h2>
                                <p>Generate receipt.</p>
                            </div>
                        </a>

                        <a href="{{url_for('all_forms')}}">
                            <div class="plaque-lg plg-3" id="viewer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25.976" height="21.509" viewBox="0 0 25.976 21.509">
                                  <g id="database" transform="translate(-1 -3)">
                                    <path id="Path_33" data-name="Path 33" d="M5,9.617V7H7.617V9.617Z" transform="translate(0.672 0.723)" fill="#fff"/>
                                    <path id="Path_34" data-name="Path 34" d="M9,9.617H22.087V7H9Z" transform="translate(0.593 0.723)" fill="#fff"/>
                                    <path id="Path_35" data-name="Path 35" d="M5,15v2.617H7.617V15Z" transform="translate(0.672 2.168)" fill="#fff"/>
                                    <path id="Path_36" data-name="Path 36" d="M22.087,17.617H9V15H22.087Z" transform="translate(0.593 2.168)" fill="#fff"/>
                                    <path id="Path_37" data-name="Path 37" d="M1,6.585A3.564,3.564,0,0,1,4.542,3H23.434a3.564,3.564,0,0,1,3.542,3.585V20.924a3.564,3.564,0,0,1-3.542,3.585H4.542A3.564,3.564,0,0,1,1,20.924ZM4.542,5.39H23.434a1.188,1.188,0,0,1,1.181,1.195v5.975H3.361V6.585A1.188,1.188,0,0,1,4.542,5.39ZM3.361,14.949v5.975a1.188,1.188,0,0,0,1.181,1.195H23.434a1.188,1.188,0,0,0,1.181-1.195V14.949Z" transform="translate(0 0)" fill="#fff" fill-rule="evenodd"/>
                                  </g>
                                </svg>

                                <h2>View All</h2>
                                <p>See all forms.</p>
                            </div>
                        </a>

                    </div>

                    </div>

                    <div class="index-tb">
                        <table class="main-table">
                            <tr><h1 class="mains">Recents</h1></tr>
                            {% if recent_forms %}
                                {% for item in recent_forms[:8] %}
                                    <tr>
                                        <td>{{ item.pseudo_id }}</td>
                                        <td><a href="{{ url_for('form_viewer', ticket_id=item.id) }}">{{item.belongs_to}}</a></td>
                                        <td class="pre-faux">{{item.no_items}}</td>
                                        <td>{{item.total_sum}}</td>
                                        <td class="pre-faux">{{item.issuance_date.date()}}</td>
                                        <td class="pre-faux"> {{ item.status }}</td>
                                    </tr>
                                {% endfor %}
                            {% else %}
                                <tr><h1>No Recent Receipts or Quotations</h1></tr>
                            {% endif %}


                        </table>
                    </div>

                </div>
            </div>

            </div>

            {% else %}
                <div class="container-form">
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages  %}
                            {% for category, message in messages %}
                                <div class="alert alert-{{category}}" id="alert">
                                  <small>{{ message }}</small>
                                </div>
                            {% endfor %}
                      {% endif %}
                    {% endwith %}

                    <form action="" method="POST" class="login-form">

                        {{ form.hidden_tag() }}
                        <h2 class="form-head">Log in</h2>
                       <div class="fieldset">
                            <div class="fields">
                                <div class="">
                                    {% if form.username.errors %}
                                        {{form.username(class='top-on filler is-invalid', placeholder='Username')}}
                                        {% for error in form.username.errors %}
                                            <div class="invalid-feedback"><span>{{error}}</span></div>
                                        {% endfor %}
                                    {% else %}
                                        {{ form.username(class='top-on filler', id="head", placeholder='Name or Username') }}
                                    {% endif %}
                                </div>
                                <div>
                                    {{ form.password(class='top-on filler', id="head", placeholder='Password') }}
                                </div>
                            </div>

                            <div class="buttons">
                                {{ form.login(class='btn btn-prime') }}
                            </div>
                       </div>


                    </form>
                </div>
            {% endif %}
        </div>
{% endblock %}
